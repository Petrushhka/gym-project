# 요구사항 정의서

##  개정 이력

| 개정날짜 | 개정 사유                                                                                                        | 개정번호 |
| :--- |:-------------------------------------------------------------------------------------------------------------| :--- |
| 2025.09.17 | 제정                                                                                                           | 00 |
| 2025.09.17 | 회원은 그룹 클래스를 수강가능하며, 비회원은 1:1 클래스를 세션단위로 수강 가능함. 또한 보통은 회원은 인터넷으로 체육관의 정회원이 되기보다는 직접적으로 눈으로 살피고 현장에서 등록하길 원함. | 01 |
| 2025.09.22 | 1인 체육관을 기준으로, 관리자 관련 부분 삭제.                                                                                  | 03 |
| 2026.01.19 | 프로젝트 상황에 맞게 요구 사항 정의서 재작성(                                                                                   | 04 |


---

## 1. 개요

* **목적**: 본 프로젝트는 개발자의 개인적인 프로젝트를 넘어, 실제 비지니스 환경에 문제점을 다루는 데 있다. 또한 Modular Monolithic Architecture를 통해, Monolitic Architecture의 단점인 ‘유지 보수 및 확장성의 제한’과 Micro Service Architecture의 단점인 ‘인프라 자원 및 비용'을 최소화 하는데 있다.
* **범위**: 본 프로젝트는 호주 헬스장의 트레이너가 회원을 관리하고, 회원 또는 회원들과 트레이너 간의 수업 시간을 예약하고, 회원이 트레이너에게 수강료를 결제하는 서비스이다.

---

## 2. 정의 및 약어

* **Payment Gateway(PG)**: 전자결제대행사로, 체육관의 회원이 예약을 할 때 카드결제, 계좌이체, 휴대폰 결제 등의 결제 방식을 이용하게 해준다.
* **Redis**: 키와 값으로 된 데이터를 메모리에 저장하는 비관계형 데이터베이스.

---

## 3. 전반적 설명

* **제품 관점**: 본 서비스는 React 기반의 프론트엔드와 Spring Boot 기반의 백엔드가 통신하며, 백엔드는 Redis, PostgreSQL, Stripe API 등 외부 서비스와 연동된다.
* **제품 기능 요약**:
    * 회원 관리: 회원가입, 로그인, 토큰 관리
    * 예약 관리: 수업 예약·취소, 좌석 동시성 제어
    * 결제 관리: 결제요청, 캡처, 환불 처리
* **사용자 특성**:
    * 트레이너: 체육관에서 상주 또는 Part-Time으로 일을 하는 인원으로, 회원과 1:1 , 1:N으로 수업을 진행하고 돈을 받는다.
    * 회원: 회원은 게스트(GUEST)와 정회원(MEMBER)으로 구분된다. 정회원은 트레이너가 개설한 1:N 수업, 1:1 수업을 예약하고 체육관에서 서비스를 이용가능하고, 비회원은 최초로 주어지는 ‘PT 체험 티켓'을 이용하여 예약만 가능하다.
    * 관리자: 모든 결제, 수업, 예약의 생성과 삭제(취소)의 전 과정을 보며 추적감사가 가능하다.
* **제약 조건**: 개발과 테스트는 한국에서 이용한다. 해당 서비스를 이용하는 사용자는 호주에서 사는 인원들이다. 헬스장의 회원들은 최대 1000명이며, 하루 이용자는 최대 150명이다.
* **가정 및 의존성**: PG(Stripe)

---

## 4. 기능 요구사항

### 4.1 회원 관리
* 비회원은 일반 회원가입과 Goolge로 소셜 회원가입을 진행할 수 있다.
* 회원가입을 성공하면 일반 회원(GUEST)로 변경된다.
* 일반 회원(GUEST)은 최초로 무료 PT 세션을 1회 지급 받는다.
* 일반 회원이(GEUST) 멤버십 상품을 구매하면 정회원(MEMBER)이 된다.
* 멤버십은 중단할 수 있으며, 최대 90일 까지 중단가능하다.
* 멤버십 중단 기간 동안 멤버십 만료 기간이 늘어난다.
* 정회원은 그룹 수업 신청이 가능하다.
* 멤버십 회원은 뭐라도 할 수
* 회원탈퇴를 할 수 있다.

### 4.2 예약 관리
* 그룹 수업은 원하는 수업을 선택하여 예약/ 취소 할 수 있다.
* 1:1PT 수업은 원하는 시간대를 선택하여 세션권을 1회 사용하여 예약이 가능하다.
* 중복예약은 불가하다.(동일 시간대 다른수업/동일수업)
* 트레이너는 예약을 강제 취소할 수 있다.
* 1:1 PT 예약 가능 한 시간은 무료 세션권과 유료 세션권의 차이를 둔다.
* 무료 세션권은 현지시간으로부터 3시간 전까지 신청할 수 있다.
* 유료 세션권은 현지시간으로부터 1시간 전까지 신청할 수 있다.
* 회원은 수업의 출석체크를 하지 않으면 NO-SHOW 처리 된다.
* 1:1 PT 수업은 예약 후 10분 이내로 취소하면 무료 취소된다.(세션권 횟수 복구)
* 1:1 PT 수업 시작 24시간 이전에 취소하면 무료 취소된다.(세션권 횟수 복구)
* 1:1 PT 수업 시작 1시간 이전에 취소하하면 세션권은 사용하여 취소한 것으로 한다.
* 1:1 PT 수업 시작 1시간 이 이내에 취소는 불가능하다.

### 4.3 수업 관리
* 트레이너는 수업 템플릿 양식을 등록할 수 있다.
* 트레이너는 정기 수업(커리큘럼, 루틴)을 등록할 수 있다.
* 커리큘럼 수업은 수업 기간 중 예약을 받을 수 없다.
* 커리큘럼 수업은 3시간 전까지만 취소할 수 있다.
* 루틴 수업은 수업 기간 중 예약을 받을 수 있다.
* 정기 수업(커리큘럼, 루틴)은 2 시간 전까지 예약 할 수 있다(추후 진행)
* 트레이너는 수업을 폐강 할 수 있다.
* 트레이너로 인해 폐강된 수업으로 인한 회원들의 세션권의 횟수는 복구된다.
* 수업의 출석체크는 수업 시작 15분전부터 가능하다.
* 수업의 출석체크는 회원이 진행하며, 체육관으로부터 회원의 150미터 이내에 위치해있을 때만 가능해야 한다.

### 4.4 결제 관리
* 관리자는 상품을 등록할 수 있다. (멤버십 , PT 세션권)
* 회원은 상품을 구매할 수 있다.
* 해당 상품의 구매요청을하면 Stripe API로부터 오는 웹훅으로부터 결제를 진행한다.
* 결제가 완료되면 상품을 지급한다.
* 결제에 실패/취소 및 서버 오류일 경우, 결제금액을 환불한다.
* 세션권의 환불타입은 전액 환불, 환불 불가 이다.
* 세션권 환불은 기간이 만료되지 않고 사용이 없었다면 전액 환불한다.
* 세션권이 한번이라도 사용되면 환불 불가하다.
* 멤버십의 환불 타입은 전액환불, 부분환불, 환불 불가만 가능하다.
* 멤버십의 시작일 전이면 전액 환불한다.
* 멤버십 시작 후 14일 이내면 날짜별로 결제금액을 일할 계산하여 부분 환불한다.
* 멤버십 시작 후 14일 이후는 환불 불가하다.

---

## 5. 비기능 요구사항
* **성능**:
    * 예약 확정 응답시간은 <= 1초
* **보안**: JWT토큰 기반인증, Stripe에서 카드정보 직접 처리
* **확장성**: Modular Monolithic 시작 -> 특정 Module 추후 MSA로 분리가능

---

## 6. 부록

* **확장 계획**: 채팅 기능, 알람 기능, 상품 관리 기능 추가, 추적 감사 부분 기능 추가